#!/usr/bin/make -f

DESTDIR=$(CURDIR)/debian/wcc
prefix=/usr
bindir=$(prefix)/bin
mandir=$(prefix)/share/man

%:
	dh $@

override_dh_auto_build:
	cargo build --release

override_dh_auto_install:
	install -Dm755 target/release/wcc $(DESTDIR)$(bindir)/wcc
	install -Dm644 build/wcc.1 $(DESTDIR)$(mandir)/man1/wcc.1

# Build the Meson source tarball once and reuse it for dpkg-source
override_dh_buildsource:
	[ -d debian/meson-build ] || meson setup debian/meson-build
	meson compile -C debian/meson-build tarball
	
